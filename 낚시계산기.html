<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë§ˆì¸í¬ë˜í”„íŠ¸ ë‚šì‹œ ì‹œë®¬ë ˆì´í„° (ë‚®/ë°¤/ë‚ ì”¨ ë°˜ì˜)</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #2b2b2b;
            color: #e0e0e0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            box-sizing: border-box;
        }
        .container {
            background-color: #3c3c3c;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.4);
            max-width: 650px;
            width: 100%;
            text-align: center;
            border: 1px solid #555;
        }
        h1 {
            color: #87CEEB; /* SkyBlue */
            margin-bottom: 25px;
            font-size: 2.2em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.6);
        }
        .input-group {
            margin-bottom: 20px;
            text-align: left;
        }
        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #b0b0b0;
        }
        .input-group input[type="number"],
        .input-group select {
            width: calc(100% - 22px);
            padding: 12px;
            border: 1px solid #555;
            border-radius: 8px;
            background-color: #4a4a4a;
            color: #e0e0e0;
            font-size: 1.1em;
            box-sizing: border-box;
        }
        .input-group input[type="number"]:focus,
        .input-group select:focus {
            border-color: #87CEEB;
            outline: none;
            box-shadow: 0 0 0 3px rgba(135, 206, 235, 0.5);
        }
        button {
            background-color: #87CEEB; /* SkyBlue */
            color: #2b2b2b;
            border: none;
            padding: 15px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.2em;
            font-weight: bold;
            transition: background-color 0.3s ease, transform 0.2s ease;
            margin-top: 15px;
        }
        button:hover {
            background-color: #6bbce6;
            transform: translateY(-2px);
        }
        .results {
            background-color: #4a4a4a;
            padding: 25px;
            margin-top: 30px;
            border-radius: 10px;
            text-align: left;
            border: 1px dashed #666;
        }
        .results h2 {
            color: #98FB98; /* PaleGreen */
            margin-bottom: 15px;
            font-size: 1.6em;
            text-align: center;
            border-bottom: 1px solid #666;
            padding-bottom: 10px;
        }
        .results p {
            font-size: 1.1em;
            margin-bottom: 8px;
            line-height: 1.6;
        }
        .results strong {
            color: #FFD700; /* Gold */
        }
        .results ul {
            list-style: none;
            padding: 0;
            margin-top: 10px;
        }
        .results ul li {
            margin-bottom: 5px;
            padding-left: 15px;
            position: relative;
        }
        .results ul li::before {
            content: 'ğŸ£';
            position: absolute;
            left: 0;
            color: #FFD700;
        }
        .error-message {
            color: #FF6347; /* Tomato */
            margin-top: 15px;
            font-weight: bold;
        }
        .note {
            font-size: 0.9em;
            color: #bbb;
            margin-top: 20px;
            border-top: 1px dashed #555;
            padding-top: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ£ë‚šì‹œ ì‹œë®¬ë ˆì´í„°</h1>
        <div class="input-group">
            <label for="fishingDurationMinutes">ë‚šì‹œí•  ì´ í˜„ì‹¤ ì‹œê°„ (ë¶„):</label>
            <input type="number" id="fishingDurationMinutes" min="1" value="240"> </div>
        <div class="input-group">
            <label for="luckOfSea">ë°”ë‹¤ì˜ í–‰ìš´ ë§ˆë²• ë¶€ì—¬ ë ˆë²¨:</label>
            <select id="luckOfSea">
                <option value="0">0 (ì—†ìŒ)</option>
                <option value="1">I</option>
                <option value="2">II</option>
                <option value="3">III</option>
            </select>
        </div>
        <div class="input-group">
            <label for="lureLevel">ë¯¸ë¼ ë§ˆë²• ë¶€ì—¬ ë ˆë²¨:</label>
            <select id="lureLevel">
                <option value="0">0 (ì—†ìŒ)</option>
                <option value="1">I</option>
                <option value="2">II</option>
                <option value="3">III</option>
            </select>
        </div>
        <div class="input-group">
            <label for="rainChance">í•˜ë£¨ ë™ì•ˆ ë¹„ê°€ ì˜¬ í™•ë¥  (%) :</label>
            <input type="number" id="rainChance" min="0" max="100" value="20">
        </div>
        <button onclick="calculateFishingResults()">ê²°ê³¼ ê³„ì‚°í•˜ê¸°</button>
        <div id="errorMessage" class="error-message"></div>
        <div id="results" class="results" style="display:none;">
            <h2>âœ¨ ì˜ˆìƒ ë‚šì‹œ ê²°ê³¼ âœ¨</h2>
            <p>ì´ í˜„ì‹¤ ë‚šì‹œ ì‹œê°„: <strong><span id="displayDurationMinutes"></span>ë¶„</strong></p>
            <p>ë§ˆì¸í¬ë˜í”„íŠ¸ ê²Œì„ ë‚´ ê²½ê³¼ ì‹œê°„: <strong><span id="mcDays"></span>ì¼ (<span id="mcHours"></span>ì‹œê°„)</strong></p>
            <p>ë°”ë‹¤ì˜ í–‰ìš´ ë ˆë²¨: <strong><span id="displayLuckLevel"></span></strong></p>
            <p>ë¯¸ë¼ ë ˆë²¨: <strong><span id="displayLureLevel"></span></strong></p>
            <p>í•˜ë£¨ ë™ì•ˆ ë¹„ ì˜¬ í™•ë¥ : <strong><span id="displayRainChance"></span>%</strong></p>
            <hr style="border-color:#555; margin:15px 0;">
            <p>ì˜ˆìƒ ì´ ë‚šì‹œ ì‹œë„ íšŸìˆ˜: <strong><span id="totalAttempts"></span>íšŒ</strong></p>
            <p>ë‚šì€ ë¬¼ê³ ê¸°: <strong><span id="fishCount"></span>íšŒ</strong> (<span id="fishPercentage"></span>)</p>
            <p>ë‚šì€ ì“°ë ˆê¸°: <strong><span id="junkCount"></span>íšŒ</strong> (<span id="junkPercentage"></span>)</p>
            <p>ë‚šì€ ë³´ë¬¼: <strong><span id="treasureCount"></span>íšŒ</strong> (<span id="treasurePercentage"></span>)</p>
            <h3>ë³´ë¬¼ ì„¸ë¶€ ë‚´ì—­ (ì˜ˆìƒ)</h3>
            <ul id="treasureDetails">
                </ul>
            <div class="note">
                <p><strong>ì°¸ê³ :</strong> ì´ ì‹œë®¬ë ˆì´ì…˜ì€ 'ê°œë°©ëœ ë¬¼' ì¡°ê±´ì´ í•­ìƒ ì¶©ì¡±ëœë‹¤ëŠ” ê°€ì • í•˜ì—, ë§ˆì¸í¬ë˜í”„íŠ¸ì˜ í†µê³„ì  í™•ë¥ ê³¼ í‰ê·  ë‚šì‹œ ì‹œê°„ì„ ê¸°ë°˜ìœ¼ë¡œ í•©ë‹ˆë‹¤.</p>
                <p>ë‚šì‹œ ì‹œê°„ì€ í‰ê· ê°’ì„ ì‚¬ìš©í•˜ë©°, í•œ ë²ˆ ë‚šì‹œì— ê±¸ë¦¬ëŠ” ìµœì†Œ/ìµœëŒ€ ì‹œê°„ ë³€ë™ì€ ë°˜ì˜ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</p>
                <p>ë§ˆì¸í¬ë˜í”„íŠ¸ í•˜ë£¨ëŠ” 20ë¶„ì…ë‹ˆë‹¤ (ë‚® 10ë¶„, ë°¤ 7ë¶„, í™©í˜¼/ìƒˆë²½ ê°ê° 1.5ë¶„).</p>
            </div>
        </div>
    </div>

    <script>
        function calculateFishingResults() {
            const fishingDurationMinutes = parseInt(document.getElementById('fishingDurationMinutes').value);
            const luckOfSeaLevel = parseInt(document.getElementById('luckOfSea').value);
            const lureLevel = parseInt(document.getElementById('lureLevel').value);
            const rainChance = parseInt(document.getElementById('rainChance').value);

            const errorMessageDiv = document.getElementById('errorMessage');
            const resultsDiv = document.getElementById('results');

            // ì…ë ¥ê°’ ìœ íš¨ì„± ê²€ì‚¬
            if (isNaN(fishingDurationMinutes) || fishingDurationMinutes <= 0) {
                errorMessageDiv.textContent = "ë‚šì‹œí•  ì´ í˜„ì‹¤ ì‹œê°„ì€ 1ë¶„ ì´ìƒì˜ ìˆ«ìì—¬ì•¼ í•©ë‹ˆë‹¤.";
                resultsDiv.style.display = 'none';
                return;
            }
            if (isNaN(rainChance) || rainChance < 0 || rainChance > 100) {
                errorMessageDiv.textContent = "ë¹„ ì˜¬ í™•ë¥ ì€ 0ì—ì„œ 100 ì‚¬ì´ì˜ ìˆ«ìì—¬ì•¼ í•©ë‹ˆë‹¤.";
                resultsDiv.style.display = 'none';
                return;
            }
            errorMessageDiv.textContent = ""; // ì˜¤ë¥˜ ë©”ì‹œì§€ ì´ˆê¸°í™”

            // --- ë§ˆì¸í¬ë˜í”„íŠ¸ ì‹œê°„ ë° í™˜ê²½ ì„¤ì • ---
            const MC_DAY_SECONDS = 20 * 60; // ë§ˆì¸í¬ë˜í”„íŠ¸ í•˜ë£¨ = 20ë¶„ = 1200ì´ˆ
            const MC_DAY_LIGHT_SECONDS = 10 * 60; // ë‚® ì‹œê°„ = 10ë¶„ = 600ì´ˆ
            const MC_NIGHT_DARK_SECONDS = 7 * 60; // ë°¤ ì‹œê°„ = 7ë¶„ = 420ì´ˆ
            const MC_TWILIGHT_SECONDS = 3 * 60; // í™©í˜¼/ìƒˆë²½ ì‹œê°„ = 3ë¶„ = 180ì´ˆ (ê°ê° 1.5ë¶„)

            // ë‚šì‹œ ì‹œê°„ì˜ ê¸°ë³¸ í‹± (í‰ê· ê°’)
            let baseAvgTicksPerCatch = 100 + 450; // ê¸°ë³¸ 5ì´ˆ(100í‹±) + ë¬´ì‘ìœ„ 0-45ì´ˆ(0-900í‹±) -> í‰ê·  25ì´ˆ(500í‹±)
            baseAvgTicksPerCatch -= (lureLevel * 100); // Lure 1ë‹¹ 100í‹±(5ì´ˆ) ê°ì†Œ
            baseAvgTicksPerCatch = Math.max(20, baseAvgTicksPerCatch); // ìµœì†Œ 1ì´ˆ (20í‹±)

            // --- ë‚šì‹œ íšŸìˆ˜ ê³„ì‚° ---
            let totalFishingSeconds = fishingDurationMinutes * 60;
            let totalAttempts = 0;

            const mcDays = Math.floor(totalFishingSeconds / MC_DAY_SECONDS);
            const remainingSeconds = totalFishingSeconds % MC_DAY_SECONDS;

            // ê° ë§ˆì¸í¬ë˜í”„íŠ¸ ë‚ ì§œë³„ë¡œ ì‹œë®¬ë ˆì´ì…˜
            for (let i = 0; i < mcDays; i++) {
                const isRaining = (Math.random() * 100) < rainChance; // ë¹„ê°€ ì˜¬ì§€ ë§ì§€ ë¬´ì‘ìœ„ ê²°ì •

                // ë‚® (ë°ìŒ)
                let currentAvgTicks = baseAvgTicksPerCatch;
                if (isRaining) currentAvgTicks *= 0.8; // ë¹„ ì˜¤ë©´ 20% ë‹¨ì¶•
                totalAttempts += Math.floor(MC_DAY_LIGHT_SECONDS / (currentAvgTicks / 20));

                // ë°¤ (ì–´ë‘ì›€)
                currentAvgTicks = baseAvgTicksPerCatch * 2; // ë°¤ì—ëŠ” ë‚šì‹œ ì‹œê°„ 2ë°°
                if (isRaining) currentAvgTicks *= 0.8; // ë¹„ ì˜¤ë©´ 20% ë‹¨ì¶•
                totalAttempts += Math.floor(MC_NIGHT_DARK_SECONDS / (currentAvgTicks / 20));

                // í™©í˜¼/ìƒˆë²½ (ì‹œê°„ì— ë”°ë¼ ë°ê¸° ë³€í•¨. ì—¬ê¸°ì„œëŠ” ë°¤ê³¼ ë™ì¼í•˜ê²Œ ì–´ë‘¡ë‹¤ê³  ê°€ì •)
                currentAvgTicks = baseAvgTicksPerCatch * 2;
                if (isRaining) currentAvgTicks *= 0.8;
                totalAttempts += Math.floor(MC_TWILIGHT_SECONDS / (currentAvgTicks / 20));
            }

            // ë‚¨ì€ ì‹œê°„ ì²˜ë¦¬ (ë§ˆì§€ë§‰ ë‚ )
            if (remainingSeconds > 0) {
                const isRaining = (Math.random() * 100) < rainChance;

                // ë‚¨ì€ ì‹œê°„ ë™ì•ˆ ë‚®, ë°¤, í™©í˜¼/ìƒˆë²½ ë¹„ì¤‘ì„ ì •í™•íˆ ë‚˜ëˆ„ê¸°ëŠ” ë³µì¡í•˜ë¯€ë¡œ,
                // ì—¬ê¸°ì„œëŠ” ë‚¨ì€ ì‹œê°„ ì „ì²´ì— ëŒ€í•´ ë¹„ì¤‘ì„ ë‘” í‰ê·  ë‚šì‹œ ì‹œê°„ì„ ì ìš©
                // (ëŒ€ëµ ë‚®:ë°¤:í™©í˜¼ = 10:7:3 ë¹„ìœ¨ë¡œ ì–´ë‘ìš´ ì‹œê°„ëŒ€ê°€ ë§ìœ¼ë¯€ë¡œ, ì–´ë‘ìš´ í™˜ê²½ ê¸°ì¤€ì— ê°€ê¹ê²Œ)
                let currentAvgTicks = baseAvgTicksPerCatch * ( (MC_DAY_LIGHT_SECONDS + MC_NIGHT_DARK_SECONDS * 2 + MC_TWILIGHT_SECONDS * 2) / MC_DAY_SECONDS );
                currentAvgTicks /= 2; // ë‹¤ì‹œ í‰ê· 
                if (isRaining) currentAvgTicks *= 0.8;
                currentAvgTicks = Math.max(20, currentAvgTicks); // ìµœì†Œ 1ì´ˆ (20í‹±)
                
                totalAttempts += Math.floor(remainingSeconds / (currentAvgTicks / 20));
            }


            // --- í™•ë¥  ê³„ì‚° ë¡œì§ (ê¸°ì¡´ê³¼ ë™ì¼) ---
            const probabilities = {
                0: {"treasure": 0.05, "fish": 0.85, "junk": 0.10},
                1: {"treasure": 0.071, "fish": 0.848, "junk": 0.081},
                2: {"treasure": 0.092, "fish": 0.847, "junk": 0.061},
                3: {"treasure": 0.113, "fish": 0.845, "junk": 0.042}
            };

            const currentProb = probabilities[luckOfSeaLevel];
            
            const treasureItems = [
                "ë§ˆë²•ì´ ë¶€ì—¬ëœ ì±…", 
                "ë§ˆë²•ì´ ë¶€ì—¬ëœ ë‚šì‹¯ëŒ€", 
                "ë§ˆë²•ì´ ë¶€ì—¬ëœ í™œ", 
                "ì´ë¦„í‘œ", 
                "ì•ˆì¥", 
                "ì•µë¬´ì¡°ê°œ ê»ë°ê¸°"
            ];

            const fishCount = Math.round(totalAttempts * currentProb.fish);
            const junkCount = Math.round(totalAttempts * currentProb.junk);
            const treasureCount = Math.round(totalAttempts * currentProb.treasure);

            const treasureDetails = {};
            const probPerTreasureItem = 1 / treasureItems.length;
            
            treasureItems.forEach(item => {
                treasureDetails[item] = Math.round(treasureCount * probPerTreasureItem);
            });

            // --- ê²°ê³¼ í‘œì‹œ ---
            document.getElementById('displayDurationMinutes').textContent = fishingDurationMinutes;
            document.getElementById('mcDays').textContent = mcDays;
            document.getElementById('mcHours').textContent = Math.round(fishingDurationMinutes * (20 / 60)); // ì‹¤ì œ ì‹œê°„ ë¶„ * (MC í•˜ë£¨ë¶„ / 60ë¶„)
            document.getElementById('displayLuckLevel').textContent = luckOfSeaLevel;
            document.getElementById('displayLureLevel').textContent = lureLevel;
            document.getElementById('displayRainChance').textContent = rainChance;
            document.getElementById('totalAttempts').textContent = totalAttempts;
            document.getElementById('fishCount').textContent = fishCount;
            document.getElementById('fishPercentage').textContent = `(${(currentProb.fish * 100).toFixed(1)}%)`;
            document.getElementById('junkCount').textContent = junkCount;
            document.getElementById('junkPercentage').textContent = `(${(currentProb.junk * 100).toFixed(1)}%)`;
            document.getElementById('treasureCount').textContent = treasureCount;
            document.getElementById('treasurePercentage').textContent = `(${(currentProb.treasure * 100).toFixed(1)}%)`;

            const treasureDetailsList = document.getElementById('treasureDetails');
            treasureDetailsList.innerHTML = '';
            for (const item in treasureDetails) {
                const li = document.createElement('li');
                li.textContent = `${item}: ${treasureDetails[item]}ê°œ`;
                treasureDetailsList.appendChild(li);
            }

            resultsDiv.style.display = 'block';
        }
    </script>
</body>
</html>